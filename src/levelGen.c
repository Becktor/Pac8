#include <ncurses.h>
#include <stdlib.h>

#define NELEMS(x)  (sizeof(x) / sizeof((x)[0]))
#define LEVELS 8
#define START_END_DEC 2
#define MODULE_LENGTH 10

int drawModule(int *level,int pos){
    int points=0;
    for(int y=0; y < MODULE_LENGTH;y++){

        for(int x=0; x< MODULE_LENGTH;x++ ){

            int tmp=y*10+x;
            if(level[tmp]==0){
                mvprintw(y,pos+x,"#");
            }else if(level[tmp]==1){
                mvprintw(y,pos+x," ");
            }else if(level[tmp]==3){
                mvprintw(y,pos+x,"8");
            }else if(level[tmp]==9){
                mvprintw(y,pos+x,"O");
                points++;
            }
        }
    }
    return points;
}

int * getLevel(int levelno)
{

    static int start0[100]={ 0,0,0,0,0,0,0,0,0,0,
                             0,3,1,1,1,1,1,1,1,0,
                             0,0,0,0,0,0,0,0,1,0,
                             0,1,1,1,1,1,1,0,1,0,
                             0,1,0,0,0,0,1,0,1,0,
                             0,1,1,1,1,0,1,0,1,0,
                             0,0,0,0,1,0,1,0,1,0,
                             0,1,9,0,1,0,1,0,1,0,
                             0,9,1,1,1,0,1,1,1,1,
                             0,0,0,0,0,0,0,0,0,0 };

    static int start1[100]={ 0,0,0,0,0,0,0,0,0,0,
                             0,3,1,1,0,9,1,1,1,0,
                             0,1,1,9,0,0,0,0,1,0,
                             0,1,0,0,0,9,1,0,1,0,
                             0,1,1,1,1,0,1,0,1,0,
                             0,1,0,0,1,0,1,0,1,0,
                             0,1,0,1,1,0,1,0,1,0,
                             0,1,0,1,0,0,1,0,1,0,
                             0,1,0,1,1,1,1,1,1,1,
                             0,0,0,0,0,0,0,0,0,0 };

    static int l0[100]={ 0,0,0,0,0,0,0,0,0,0,
                         1,1,1,0,1,1,1,0,1,1,
                         1,0,1,0,1,0,1,0,1,1,
                         1,0,1,0,1,0,1,0,1,1,
                         1,0,1,1,1,0,1,1,1,1,
                         1,0,0,0,0,0,0,0,0,0,
                         1,1,1,1,1,1,0,9,1,1,
                         1,1,0,1,0,1,0,1,0,1,
                         1,9,0,9,0,9,1,1,0,1,
                         0,0,0,0,0,0,0,0,0,0 };

    static int l1[100]={ 0,0,0,0,0,0,0,0,0,0,
                         0,1,1,1,1,1,1,0,9,0,
                         1,1,1,0,1,0,1,0,9,0,
                         1,0,9,0,1,0,1,0,9,0,
                         0,1,0,1,1,0,1,0,1,1,
                         1,1,1,1,0,1,1,0,1,1,
                         1,1,1,0,1,1,1,1,1,1,
                         1,1,0,1,1,1,1,1,0,1,
                         1,1,1,1,1,1,1,1,0,1,
                         0,0,0,0,0,0,0,0,0,0 };

    static int l2[100]={ 0,0,0,0,0,0,0,0,0,0,
                         1,1,1,1,1,1,1,0,9,0,
                         1,1,1,0,1,0,1,0,9,0,
                         1,0,9,0,1,0,1,0,9,0,
                         0,1,0,1,1,0,1,0,1,1,
                         1,1,1,1,0,0,0,0,1,1,
                         1,1,1,1,1,1,1,1,1,0,
                         1,1,0,1,1,1,1,1,0,1,
                         1,1,1,1,1,1,1,1,1,1,
                         0,0,0,0,0,0,0,0,0,0 };

    static int l3[100]={ 0,0,0,0,0,0,0,0,0,0,
                         1,1,1,1,1,1,1,1,1,1,
                         1,0,0,0,0,0,0,0,0,0,
                         1,1,1,1,1,1,1,1,1,1,
                         1,0,0,1,1,1,1,0,0,0,
                         1,0,1,0,1,1,0,1,1,1,
                         1,0,1,1,0,0,1,1,1,1,
                         1,0,1,1,1,1,1,9,1,1,
                         1,1,1,0,9,9,9,1,1,1,
                         0,0,0,0,0,0,0,0,0,0 };

    static int l4[100]={ 0,0,0,0,0,0,0,0,0,0,
                         1,0,1,1,1,1,1,1,0,1,
                         1,1,0,1,1,0,9,0,1,1,
                         1,1,1,0,1,1,0,1,1,1,
                         1,1,1,1,1,1,1,1,1,1,
                         1,1,1,1,1,1,1,1,1,1,
                         1,1,1,0,1,1,0,1,1,1,
                         1,1,0,9,0,1,1,0,1,1,
                         1,0,1,1,1,1,1,1,0,1,
                         0,0,0,0,0,0,0,0,0,0 };

    static int l5[100]={0,0,0,0,0,0,0,0,0,0,
                        1,0,1,1,1,1,1,1,1,1,
                        1,0,1,9,0,9,1,1,0,1,
                        1,1,1,0,0,0,1,1,0,1,
                        1,1,0,1,1,1,0,1,1,1,
                        1,1,0,1,1,1,0,1,1,1,
                        1,1,1,1,0,1,1,1,1,1,
                        1,1,1,1,0,1,1,1,1,1,
                        1,1,1,1,1,1,1,1,1,1,
                        0,0,0,0,0,0,0,0,0,0 };

    static int l6[100]={0,0,0,0,0,0,0,0,0,0,
                        1,1,1,1,1,1,1,1,1,0,
                        0,0,0,0,0,0,0,0,1,0,
                        0,1,1,9,0,1,1,1,1,0,
                        0,1,0,0,0,1,1,1,0,1,
                        0,1,1,1,1,1,1,0,1,1,
                        0,0,0,1,1,1,0,1,1,1,
                        1,1,1,1,1,0,1,1,1,1,
                        1,1,1,1,1,1,1,1,1,1,
                        0,0,0,0,0,0,0,0,0,0 };

    static int l7[100]={ 0,0,0,0,0,0,0,0,0,0,
                         1,1,1,1,1,1,1,1,1,1,
                         1,1,0,0,0,0,0,0,1,1,
                         1,0,1,1,1,1,1,1,0,1,
                         1,0,1,0,0,0,1,1,0,1,
                         1,0,1,0,9,9,0,1,0,1,
                         1,0,1,0,9,9,1,1,0,1,
                         1,0,1,1,0,0,0,0,1,1,
                         1,1,0,1,1,1,1,1,1,1,
                         0,0,0,0,0,0,0,0,0,0 };

    static int end0[100]={0,0,0,0,0,0,0,0,0,0,
                         1,0,1,1,0,1,1,1,1,0,
                         1,1,1,0,1,1,1,1,1,0,
                         1,1,0,1,1,0,0,0,1,0,
                         1,0,1,1,0,0,1,1,1,0,
                         0,1,1,0,1,0,1,0,0,0,
                         1,1,0,1,1,0,1,0,9,0,
                         1,0,1,1,0,0,1,0,9,0,
                         0,9,1,1,1,1,1,1,1,0,
                         0,0,0,0,0,0,0,0,0,0 };

    static int end1[100]={0,0,0,0,0,0,0,0,0,0,
                          1,0,1,1,1,1,1,1,1,0,
                          1,1,0,0,0,0,0,1,1,0,
                          0,1,0,1,1,1,1,1,1,0,
                          0,1,0,0,0,0,1,1,1,0,
                          0,1,1,1,1,0,1,0,0,0,
                          1,1,0,0,0,0,1,0,9,0,
                          1,1,1,1,1,1,1,0,9,0,
                          1,9,1,1,1,1,1,1,1,0,
                          0,0,0,0,0,0,0,0,0,0 };

    static int test[100]={0,0,0,0,0,0,0,0,0,0,
                          0,1,1,1,1,1,1,1,1,0,
                          0,1,1,1,1,1,1,1,1,0,
                          0,1,1,1,1,1,1,1,1,0,
                          0,1,1,1,9,9,1,1,1,0,
                          0,1,1,1,9,9,1,1,1,0,
                          0,1,1,1,1,1,1,1,1,0,
                          0,1,1,1,1,1,1,1,1,0,
                          0,1,1,1,1,1,1,1,1,0,
                          0,0,0,0,0,0,0,0,0,0 };

    switch(levelno) {
    case 0 :
        return l0;
    case 1 :
        return l1;
    case 2 :
        return l2;
    case 3 :
        return l3;
    case 4 :
        return l4;
    case 5 :
        return l5;
    case 6 :
        return l6;
    case 7 :
        return l7;
    case 100 :
        return start0;
    case 101 :
        return start1;
    case 102 :
        return end0;
    case 103 :
        return end1;
    case 999 :
        return test;
    default :
        printf("no such level\n" );
    }
    return 0;
}
int genLevel(int size)
{
    int * level;
    int tmp[size-START_END_DEC];
    int end = rand()%2;
    int start = rand()%2;
    int points=0;
    int testLevel=999;


    if(size>0){
        for(int i=0;i<size-START_END_DEC;i++){
            tmp[i]= rand()%LEVELS;
        }

        for(int k=0;k<size;k++){

            if (k==0){
                level = getLevel(100+start);
                points=points+drawModule(level,k*10);
            }
            else if (k==size-1){
                level = getLevel(102+end);
                points=points+drawModule(level,k*10);
            }

            else{
                level = getLevel(tmp[k-1]);
                points=points+drawModule(level,k*10);
            }

        }
    }else{
        level=getLevel(testLevel);
        points=points+drawModule(level,0);
    }
    return points;
}

void drawPlayer(int playerPos, int * level){

    level[playerPos]=11;
}
